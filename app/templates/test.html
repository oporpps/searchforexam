{% extends 'layout/default.html' %}

{% block title %}
    แสดงโน้ต
{% endblock %}

{% block content %}

<style>
    /* CSS for adding margin at the top */
    .container {
        margin-top: 50px; /* Adjust the margin as needed */
        margin-bottom: 20px; /* Adjust the margin as needed */
    }

    .table-container {
        margin-bottom: 20px; /* Adjust the margin as needed */
    }

    /* Add some padding to the textareas */
    textarea {
        padding: 5px;
        width: 100%; /* Make textarea fill the cell */
    }

    /* Style for the delete button */
    .delete-button {
        background-color: #ff6666; /* Red color for delete button */
        color: white;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
    }
</style>

<div class="table-container">
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>หัวข้อ</th>
                <th>ข้อ</th>
                <th>คำตอบ</th>
                <th>ดำเนินการ</th> <!-- Added a new header for the delete button -->
            </tr>
        </thead>
        <tbody>
            {% for user in contentx %}
                <tr>
                    <td>{{ user.หัวข้อ }}</td>
                    <td>{{ user.ข้อ }}</td>
                    <td>{{ user.คำตอบ }}</td>
                    <td>
                        <button class="delete-button" onclick="deleteRow('{{ user.id }}')">ลบ</button>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    function deleteRow(userId) {
        const deleteUrl = `/add_to_data`;
    
        const formData = new FormData();
        formData.append('action', 'delete');
        formData.append('user_id', userId);
    
        fetch(deleteUrl, {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            if (data.success) {
                const rowToDelete = document.querySelector(`tr[data-id="${userId}"]`);
                if (rowToDelete) {
                    rowToDelete.remove();
                }
            } else {
                alert('Failed to delete the user. Please try again.');
            }
        })
        .catch(error => {
            console.error('Error deleting the user:', error);
            alert('An error occurred while deleting the user. Please try again later.');
        });
    }
</script>

{% endblock %}
